<!DOCTYPE html>
<html lang="en" class="w-full h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Page</title>
    <script src="https://kit.fontawesome.com/4238f643fe.js" crossorigin="anonymous"></script>
    <link href="/output.css" rel="stylesheet" />
    <script defer src="../profile-front-end/profile.js"></script>
</head>

<body class="bg-gray-100 w-full h-screen overflow-auto flex flex-col">
    <header class="p-10 bg-white"></header>
    <div class="flex justify-center h-full mb-32">
        <div class="w-full md:w-full rounded-lg h-full">
            <div class="flex flex-col items-center w-full">
                <a href="/profile/1">
                    <img src="<%- user.profileImageURI %>" alt="User avatar"
                        class="rounded-full object-cover w-32 h-32 -mt-16">
                </a>
                <div class="mt-10 w-full">
                    <div class="flex flex-col md:flex-row justify-between items-start w-full mb-8">
                        <div>
                            <h1 class="px-4 text-3xl font-bold mb-2">
                                <%- user.name %>
                            </h1>
                        </div>
                        <% if (user && !currentUser) { %>
                            <div class="flex flex-col space-y-2 px-3">
                                <div class="flex space-x-4">
                                    <button id="followBtn"
                                        class="rounded-2xl border border-[#878d26] px-3 py-1 m-1 text-base"
                                        data-user-id="<%-user.id%>">
                                        <i id="followIcon" class="fas fa-user-plus text-base text-[#878d26] mr-2"></i>
                                        Follow
                                    </button>
                                    <button class="rounded-2xl border border-[#878d26] px-3 py-1 m-1 text-base">
                                        <i class="fas fa-comment text-base text-[#878d26] mr-2"></i>
                                        Message
                                    </button>
                                </div>
                            </div>
                            <% } %>
                    </div>
                </div>
                <div class="flex justify-center">
                    <h1 class="text-2xl font-bold">
                        <% if (currentUser) { %>
                            My Posts
                            <% } else { %>
                                <%- user.name %>'s Posts
                                    <% } %>
                    </h1>
                </div>
            </div>
            <div class="flex flex-col container m-auto sm:w-full mt-4 pb-20 sm:grid sm:grid-cols-2" id="posts">
                <% posts.forEach(post=> { %>
                    <div
                        class="relative post-card flex flex-col justify-between items-center border border-gray-100 rounded-xl shadow-md mb-4 h-64 w-10/12 box-border overflow-hidden hover:shadow-lg cursor-pointer m-auto bg-gray-50 max-w-sm sm:max-w-full sm:mb-5 sm:h-72 sm:w-11/12 lg:w-10/12 lg:mb-8">
                        <div class="w-full h-3/4 flex justify-center items-center">
                            <img src="<%- post.imageUrl  %>" class="object-cover rounded-xl h-full w-full max-w-full"
                                alt="<%- post.caption %>">
                        </div>
                        <div class='flex flex-col justify-evenly p-1 items-center w-full overflow-hidden'>
                            <h3 class='text-md font-semibold line-clamp-1 w-11/12 sm:text-xl text-center'>
                                <%- post.title %>
                            </h3>
                            <div class="flex items-center justify-between h-1/4 w-full px-4 pb-2 mt-2">
                                <div class="flex items-center justify-center mr-2 relative">
                                    <a class="absolute w-full h-full top-0 left-0 z-20"
                                        href="/user-profile/<%-post.author.id %>"></a>
                                    <img src="<%-post.author.profileImageURI%>"
                                        class="w-4 h-4 sm:h-6 sm:w-6 rounded-full mr-1" alt="<%-post.author.name%>">
                                    <p class='text-xs sm:text-sm text-left line-clamp-2'>
                                        <%-post.author.name%>
                                    </p>
                                </div>
                                <p class='text-xs sm:text-sm text-center mr-2'>
                                    <i class="fas fa-map-marker-alt text-center w-4 h-4 mr-1 text-black"></i>
                                    <%-post.location%>
                                </p>
                                <p class='text-xs sm:text-sm text-center line-clamp-2'>
                                    <i class="far fa-calendar-alt text-center w-4 h-4 mr-1 text-black"></i>
                                    <%- new Date(post.createdAt).toLocaleDateString('en-US', { month: 'long' ,
                                        day: 'numeric' , year: 'numeric' }) %>
                                </p>
                            </div>
                        </div>
                    </div>
                    <% }); %>
            </div>
        </div>
    </div>
    <%- include("../partials/footer.ejs") %>
</body>

</html>